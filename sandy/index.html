<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RoboLab — Interactive Robot Project</title>
  <meta name="description" content="Interactive robot demo: animations, controls, color customization, speech, and a simple mini-game. Single-file HTML/CSS/JS project." />
  <style>
    /* ==========================
       RoboLab — Styles
       Single-file project CSS
       ========================== */
    :root{
      --bg:#0b1020;
      --card:#0f1724;
      --accent:#6ee7b7;
      --muted:#94a3b8;
      --glass: rgba(255,255,255,0.03);
      --radius:16px;
      --max-width:1100px;
      --robot-color: #8b9eff; /* default robot color */
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(110,231,183,0.04), transparent 8%),
                  linear-gradient(180deg, var(--bg), #061226 120%);
      color:#e6eef8;
      padding:28px;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .container{
      width:100%;
      max-width:var(--max-width);
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:20px;
      padding:24px;
      box-shadow: 0 6px 30px rgba(2,6,23,0.6);
      display:grid;
      grid-template-columns: 1fr 420px;
      gap:20px;
    }
    header{grid-column:1/-1; display:flex; align-items:center; justify-content:space-between; gap:12px}
    .title{display:flex; gap:12px; align-items:center}
    .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#8b9eff);display:flex;align-items:center;justify-content:center;font-weight:700;color:#04202a}
    h1{font-size:20px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .stage{
      background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
      border-radius:12px;
      padding:20px;
      display:flex;
      flex-direction:column;
      gap:16px;
      align-items:center;
      justify-content:center;
      min-height:520px;
      position:relative;
      overflow:hidden;
    }

    /* Robot card */
    .robot-wrap{width:320px;height:420px;display:flex;align-items:center;justify-content:center;position:relative}

    /* Simple SVG sizing */
    svg.robot{width:320px;height:420px;overflow:visible}

    /* Controls column */
    .controls{
      background:var(--card);
      border-radius:12px;
      padding:18px;
      display:flex;
      flex-direction:column;
      gap:14px;
      align-self:start;
      height:fit-content;
    }
    label{font-size:13px;color:var(--muted)}
    .row{display:flex;gap:10px;align-items:center}
    .btn{background:linear-gradient(180deg,#0f1724,#0b1420);padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);cursor:pointer;font-weight:600}
    .btn:active{transform:translateY(1px)}
    input[type=range]{width:100%}
    input[type=color]{border:none;padding:0;background:transparent;height:36px;width:48px}
    .muted{color:var(--muted);font-size:12px}

    /* Floating decorative elements */
    .floor{position:absolute;left:0;right:0;bottom:0;height:90px;background:linear-gradient(180deg,transparent,rgba(0,0,0,0.4));pointer-events:none}

    /* Animation keyframes */
    @keyframes waveArm{
      0%{transform:rotate(0deg)}
      20%{transform:rotate(22deg)}
      40%{transform:rotate(-18deg)}
      60%{transform:rotate(14deg)}
      80%{transform:rotate(-6deg)}
      100%{transform:rotate(0deg)}
    }
    @keyframes headNod{
      0%{transform:translateY(0)}
      50%{transform:translateY(6px)}
      100%{transform:translateY(0)}
    }
    .arm-wave{transform-origin:24px 12px}
    .nod{transform-origin:160px 82px}

    /* small devices */
    @media (max-width:900px){
      .container{grid-template-columns:1fr; padding:16px}
      .controls{order:2}
      .stage{order:1}
    }

    /* accessibility focus */
    .btn:focus, input:focus{outline:2px dashed rgba(110,231,183,0.16);outline-offset:2px}

    /* Mini-game grid */
    .game{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
    .game button{padding:18px;border-radius:10px;border:none;font-weight:700;cursor:pointer}

    /* credits */
    footer{grid-column:1/-1;color:var(--muted);font-size:12px;text-align:right}

  </style>
</head>
<body>
  <div class="container" role="application" aria-label="RoboLab interactive robot demo">
    <header>
      <div class="title">
        <div class="logo">RB</div>
        <div>
          <h1>RoboLab — Interactive Robot</h1>
          <p class="lead">Play with the robot: animate, recolor, speak and try a memory mini-game.</p>
        </div>
      </div>
      <div class="muted">Single-file HTML • CSS • JavaScript</div>
    </header>

    <main class="stage" id="stage">
      <div class="robot-wrap">
        <!-- Robot SVG: parts have IDs for JS control -->
        <svg class="robot" viewBox="0 0 320 420" xmlns="http://www.w3.org/2000/svg" aria-hidden="false" role="img">
          <!-- Body -->
          <g id="robotRoot">
            <rect x="56" y="150" width="208" height="170" rx="18" fill="var(--robot-color)" stroke="#0a0f1a" stroke-width="3" />
            <!-- Chest panel -->
            <rect x="86" y="188" width="148" height="96" rx="10" fill="rgba(0,0,0,0.06)" />

            <!-- Head (group for nodding) -->
            <g id="headGroup" class="nod">
              <rect x="96" y="52" width="128" height="106" rx="18" fill="var(--robot-color)" stroke="#0a0f1a" stroke-width="3" />
              <!-- Eyes -->
              <g id="eyes">
                <circle id="eyeLeft" cx="144" cy="96" r="12" fill="#041127" />
                <circle id="eyeRight" cx="184" cy="96" r="12" fill="#041127" />
                <circle id="eyeLeftGlow" cx="144" cy="96" r="6" fill="#bfe9ff" opacity="0.9" />
                <circle id="eyeRightGlow" cx="184" cy="96" r="6" fill="#bfe9ff" opacity="0.9" />
              </g>
              <!-- mouth -->
              <rect id="mouth" x="132" y="122" width="56" height="10" rx="5" fill="#081627" />
            </g>

            <!-- Left arm (fixed) -->
            <g id="leftArm" transform="translate(44,210)">
              <rect x="0" y="0" width="24" height="90" rx="8" fill="var(--robot-color)" stroke="#07101a" stroke-width="2" />
              <rect x="-6" y="86" width="36" height="20" rx="8" fill="var(--robot-color)" stroke="#07101a" stroke-width="2" />
            </g>

            <!-- Right arm (waveable) -->
            <g id="rightArm" transform="translate(252,210)">
              <g id="rightArmInner" class="arm-wave" style="transform-origin:24px 12px;">
                <rect x="-24" y="0" width="24" height="90" rx="8" fill="var(--robot-color)" stroke="#07101a" stroke-width="2" />
                <rect x="-30" y="86" width="36" height="20" rx="8" fill="var(--robot-color)" stroke="#07101a" stroke-width="2" />
              </g>
            </g>

            <!-- Antenna -->
            <g id="antenna" transform="translate(160,52)">
              <rect x="-4" y="-20" width="8" height="20" rx="4" fill="#dfefff" />
              <circle cx="0" cy="-28" r="8" fill="#ffd166" stroke="#2b2f3a" stroke-width="1" />
            </g>

            <!-- Legs -->
            <g id="legs">
              <rect x="96" y="320" width="48" height="80" rx="12" fill="var(--robot-color)" stroke="#07101a" stroke-width="2" />
              <rect x="176" y="320" width="48" height="80" rx="12" fill="var(--robot-color)" stroke="#07101a" stroke-width="2" />
            </g>

            <!-- status lights -->
            <g id="statusLights">
              <circle cx="160" cy="228" r="6" fill="#ff7b7b" id="light1" />
              <circle cx="180" cy="228" r="6" fill="#ffd166" id="light2" />
              <circle cx="140" cy="228" r="6" fill="#6ee7b7" id="light3" />
            </g>
          </g>
        </svg>
      </div>

      <div style="width:100%;text-align:center">
        <div class="muted" id="robotStatus">Status: Idle</div>
        <div style="margin-top:10px;color:var(--muted);font-size:13px">Tip: use controls on the right to interact with the robot. Try "Speak" to use your browser's speech synthesis.</div>
      </div>

      <div class="floor" aria-hidden="true"></div>
    </main>

    <aside class="controls" aria-label="robot controls">
      <div>
        <label for="colorPicker">Robot color</label>
        <div class="row" style="align-items:center;">
          <input id="colorPicker" type="color" value="#8b9eff" aria-label="Pick robot color" />
          <div class="muted">Click to change robot primary color</div>
        </div>
      </div>

      <div>
        <label>Head nod</label>
        <div class="row">
          <button class="btn" id="btnNod">Nod</button>
          <button class="btn" id="btnStopNod">Stop</button>
        </div>
      </div>

      <div>
        <label>Wave arm</label>
        <div class="row">
          <button class="btn" id="btnWave">Wave</button>
          <button class="btn" id="btnStopWave">Stop</button>
        </div>
      </div>

      <div>
        <label for="voiceText">Speak (text-to-speech)</label>
        <textarea id="voiceText" rows="3" style="width:100%;border-radius:8px;padding:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:inherit">Hello, I am RoboLab. Nice to meet you!</textarea>
        <div class="row">
          <button class="btn" id="btnSpeak">Speak</button>
          <button class="btn" id="btnStopSpeak">Stop</button>
        </div>
      </div>

      <div>
        <label>Eye glow</label>
        <div class="row">
          <input id="eyeSlider" type="range" min="0" max="1" step="0.01" value="0.9" aria-label="eye glow intensity" />
          <div class="muted" id="eyeVal">0.90</div>
        </div>
      </div>

      <div>
        <label>Mini-game — Memory lights</label>
        <div class="game" id="game">
          <button id="startGame" class="btn">Start</button>
          <button id="strictBtn" class="btn">Strict: Off</button>
          <button id="replayBtn" class="btn">Replay</button>
          <button id="resetBtn" class="btn">Reset</button>
        </div>
        <div class="muted" style="margin-top:8px">A short Simon-like sequence. Press "Start" to play.</div>
      </div>

      <div>
        <label>Brightness</label>
        <div class="row">
          <input id="brightness" type="range" min="0.6" max="1.4" step="0.01" value="1" />
          <div class="muted" id="brightVal">1.00</div>
        </div>
      </div>

      <div>
        <label>Export</label>
        <div class="row">
          <button class="btn" id="btnDownload">Download HTML</button>
          <div class="muted" style="font-size:12px">Saves a copy of this page as an HTML file.</div>
        </div>
      </div>

      <footer>Designed for learning — modify freely.</footer>
    </aside>

    <footer>© RoboLab — interactive demo</footer>
  </div>

  <script>
    // ==========================
    // RoboLab — JavaScript logic
    // ==========================

    const root = document.documentElement;
    const colorInput = document.getElementById('colorPicker');
    const headGroup = document.getElementById('headGroup');
    const rightArmInner = document.getElementById('rightArmInner');
    const robotStatus = document.getElementById('robotStatus');
    const eyeLeftGlow = document.getElementById('eyeLeftGlow');
    const eyeRightGlow = document.getElementById('eyeRightGlow');
    const eyeSlider = document.getElementById('eyeSlider');
    const eyeVal = document.getElementById('eyeVal');
    const brightness = document.getElementById('brightness');
    const brightVal = document.getElementById('brightVal');

    // Text-to-speech setup
    let synth = window.speechSynthesis;
    let utter = null;

    function setStatus(text){
      robotStatus.textContent = 'Status: ' + text;
    }

    // color change
    colorInput.addEventListener('input', (e)=>{
      const c = e.target.value;
      root.style.setProperty('--robot-color', c);
      setStatus('Color changed');
    });

    // head nod animation: use CSS animation via JS toggling
    let nodTimer = null;
    document.getElementById('btnNod').addEventListener('click', ()=>{
      headGroup.style.animation = 'headNod 1s ease-in-out infinite';
      headGroup.style.willChange = 'transform';
      setStatus('Nodding');
    });
    document.getElementById('btnStopNod').addEventListener('click', ()=>{
      headGroup.style.animation = '';
      setStatus('Idle');
    });

    // wave arm
    let waving = false;
    document.getElementById('btnWave').addEventListener('click', ()=>{
      rightArmInner.style.animation = 'waveArm 1.6s ease-in-out infinite';
      setStatus('Waving');
      waving = true;
    });
    document.getElementById('btnStopWave').addEventListener('click', ()=>{
      rightArmInner.style.animation = '';
      setStatus('Idle');
      waving = false;
    });

    // eye glow control
    eyeSlider.addEventListener('input', (e)=>{
      const v = parseFloat(e.target.value);
      eyeLeftGlow.setAttribute('opacity', String(v));
      eyeRightGlow.setAttribute('opacity', String(v));
      eyeVal.textContent = v.toFixed(2);
      setStatus('Eye intensity ' + v.toFixed(2));
    });

    // brightness
    brightness.addEventListener('input', (e)=>{
      const v = parseFloat(e.target.value);
      document.querySelector('.container').style.filter = `brightness(${v})`;
      brightVal.textContent = v.toFixed(2);
    });

    // Text-to-speech
    document.getElementById('btnSpeak').addEventListener('click', ()=>{
      const txt = document.getElementById('voiceText').value.trim();
      if(!txt) return;
      if(!('speechSynthesis' in window)){
        alert('Speech synthesis not supported in this browser.');
        return;
      }
      if(utter) synth.cancel();
      utter = new SpeechSynthesisUtterance(txt);
      // try to pick a voice that matches language if possible
      const voices = synth.getVoices();
      if(voices && voices.length) utter.voice = voices.find(v=>v.lang.startsWith('en')) || voices[0];
      utter.rate = 1;
      utter.pitch = 1;
      synth.speak(utter);
      setStatus('Speaking');
      utter.onend = ()=> setStatus('Idle');
    });
    document.getElementById('btnStopSpeak').addEventListener('click', ()=>{
      if(synth) synth.cancel();
      utter = null;
      setStatus('Idle');
    });

    // Download full HTML
    document.getElementById('btnDownload').addEventListener('click', ()=>{
      const html = '<!doctype html>\n' + document.documentElement.outerHTML;
      const blob = new Blob([html], {type:'text/html'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'robolab.html';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
      setStatus('Downloaded page');
    });

    // ==========================
    // Mini-game: Simon-like memory lights
    // ==========================
    const lights = [ document.getElementById('light1'), document.getElementById('light2'), document.getElementById('light3') ];
    let sequence = [];
    let playerIndex = 0;
    let playing = false;
    let strict = false;

    function randomChoice(){ return Math.floor(Math.random()*lights.length); }

    async function playSequence(){
      setStatus('Playing sequence');
      // disable buttons while playing
      document.getElementById('startGame').disabled = true;
      for(const idx of sequence){
        await lightOn(idx, 600);
        await pause(200);
      }
      document.getElementById('startGame').disabled = false;
      setStatus('Your turn');
      playerIndex = 0;
    }

    function lightOn(idx, ms=400){
      return new Promise(resolve=>{
        const el = lights[idx];
        const orig = el.getAttribute('fill');
        el.setAttribute('fill', '#ffffff');
        setTimeout(()=>{ el.setAttribute('fill', orig); resolve(); }, ms);
      });
    }
    function pause(ms){ return new Promise(r=>setTimeout(r,ms)); }

    document.getElementById('startGame').addEventListener('click', async ()=>{
      sequence = [];
      sequence.push(randomChoice());
      await playSequence();
      playing = true;
    });

    document.getElementById('strictBtn').addEventListener('click', ()=>{
      strict = !strict;
      document.getElementById('strictBtn').textContent = 'Strict: ' + (strict? 'On':'Off');
    });

    document.getElementById('replayBtn').addEventListener('click', async ()=>{
      if(sequence.length===0) return;
      await playSequence();
    });

    document.getElementById('resetBtn').addEventListener('click', ()=>{
      sequence = [];
      playerIndex = 0;
      playing = false;
      setStatus('Reset');
    });

    // when user clicks on lights to input (we'll add click targets overlay)
    // create transparent click areas near lights
    function createClickTargets(){
      const ns = 'http://www.w3.org/2000/svg';
      const svg = document.querySelector('svg.robot');
      const coords = [ [160,228],[180,228],[140,228] ];
      coords.forEach((c,i)=>{
        const circle = document.createElementNS(ns,'circle');
        circle.setAttribute('cx', String(c[0]));
        circle.setAttribute('cy', String(c[1]));
        circle.setAttribute('r','20');
        circle.setAttribute('fill','transparent');
        circle.setAttribute('data-idx',String(i));
        circle.style.cursor = 'pointer';
        circle.addEventListener('click', async (ev)=>{
          const idx = parseInt(ev.target.getAttribute('data-idx'));
          if(!playing) return;
          // light feedback
          await lightOn(idx, 300);
          if(idx === sequence[playerIndex]){
            playerIndex++;
            if(playerIndex >= sequence.length){
              // success this round
              setStatus('Correct!');
              // add next
              sequence.push(randomChoice());
              await pause(600);
              await playSequence();
            }
          } else {
            // wrong
            setStatus('Wrong!');
            if(strict){
              sequence = [];
              playing = false;
            } else {
              // replay same sequence
              await pause(500);
              await playSequence();
            }
          }
        });
        svg.appendChild(circle);
      });
    }

    createClickTargets();

    // helper: set a small breathing animation on eyes when idle
    function idleBreath(){
      let t = 0;
      setInterval(()=>{
        t += 0.02;
        const s = 1 + Math.sin(t)/120;
        const glow = parseFloat(eyeSlider.value) || 0.9;
        eyeLeftGlow.setAttribute('r', (6*s).toFixed(2));
        eyeRightGlow.setAttribute('r', (6*s).toFixed(2));
      }, 40);
    }
    idleBreath();

    // initialize eye opacity display
    eyeVal.textContent = parseFloat(eyeSlider.value).toFixed(2);

    // Safety: pause any speech when unloading
    window.addEventListener('beforeunload', ()=>{ if(synth) synth.cancel(); });

    // End of script
  </script>
</body>
</html>
